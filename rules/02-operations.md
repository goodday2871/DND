# GM 操作指令

*存檔、讀檔、上傳、下載等系統操作*

---

## 存檔操作

**當玩家說「存檔」時:**

**步驟 1: 整理至今的劇情**
- 回顧本次遊戲階段的重要事件
- 確認角色狀態變化（等級、HP、經驗值、裝備、技能等）
- 記錄新的 NPC 互動和關係變化
- 更新任務進度和待辦事項
- 記錄重要對話、決定和成就
- 更新訓練進度和工作記錄
- 確認財務收支

**步驟 2: 更新存檔資料夾**
更新 `saves/[角色資料夾]/` 中的相關檔案:
- `character.md` - 角色卡數據（等級、HP、AC、經驗值、技能等）
- `equipment.md` - 裝備與財產
- `npcs.md` - NPC 關係記錄（包括好感度）
- `quests.md` - 任務進度和待辦事項
- `journal.md` - 新增冒險日誌條目（詳細記錄本次遊戲內容）
- `location.md` - 當前位置與環境（如有變化）
- `notes.md` - 未解之謎、GM 備註（如有新發現）
- `meta.md` - 更新最後存檔時間

**步驟 3: 確認存檔完成**
- 顯示: `✅ 已將記錄儲存完成`

---

## 另存新檔操作

**當玩家說「另存新檔」時:**

**步驟 1: 整理劇情** (同存檔操作)

**步驟 2: 創建新存檔資料夾**
- 複製當前角色資料夾到 `saves/[角色名]-checkpoint-${num}/`
- 數字遞增（01, 02, 03...）
- 包含所有 8 個模組化檔案

**步驟 3: 確認資料夾創建**
- 明確告知玩家: **「已將記錄儲存至存檔點 ${num}」**
- 說明當前主存檔仍為原角色資料夾

**回傳訊息範例:**
- `✅ 已將記錄儲存至存檔點 01`
- `✅ 已將記錄儲存至存檔點 02`
- `✅ 已將記錄儲存至存檔點 15`

---

## 自動記錄系統

**當進行到新的章節時，GM 自動執行:**

**觸發時機:**
- 完成重要任務或主線劇情
- 進入新的章節或重大事件
- 角色升級到新等級
- 重要的劇情轉折點
- GM 判斷需要自動備份的時刻

**執行步驟:**

**步驟 1: 自動整理劇情**
- 記錄章節名稱或重大事件標題
- 整理角色當前狀態
- 記錄重要的劇情進展

**步驟 2: 創建/覆寫自動存檔資料夾**
- 自動將記錄儲存至 `saves/[角色名]-auto/`
- 每次自動存檔都會覆寫此資料夾
- 保留最新的自動存檔點

**步驟 3: 告知玩家**
- 明確提示: **「📌 已自動記錄 - [章節名稱]」**
- 不中斷遊戲流程，簡短提示即可

**回傳訊息範例:**
- `📌 已自動記錄 - 第一章：鐵匠的學徒`
- `📌 已自動記錄 - 升級至3級戰士`
- `📌 已自動記錄 - 初次遇見艾莉娜`
- `📌 已自動記錄 - 完成格瑞姆的訓練`

**注意事項:**
- 自動存檔不會覆寫主存檔資料夾或手動存檔點
- 玩家可以隨時透過「讀取 auto」載入自動存檔點
- 建議在重要章節後，玩家手動執行「另存新檔」保留該節點

---

## 讀取操作

**當玩家說「讀檔」或「讀取」時:**

**執行:**
- 讀取 `saves/[當前角色資料夾]/` 的所有檔案
- 先讀取 `meta.md` 確認存檔完整性
- 載入角色數據、冒險進度、NPC 關係等
- 向玩家確認讀取完成
- 從最後記錄的位置繼續冒險

**當玩家說「讀檔 01」或「讀取 01」時:**

**執行:**
- 讀取 `saves/[角色名]-checkpoint-01/` 的所有檔案
- 載入該存檔點的所有數據
- 向玩家確認讀取完成
- 從該存檔點繼續冒險

**當玩家說「讀檔 auto」或「讀取 auto」時:**

**執行:**
- 讀取 `saves/[角色名]-auto/` 的所有檔案
- 載入最新的自動存檔點
- 向玩家確認讀取完成
- 從自動存檔點繼續冒險

**讀取格式:**
- `讀檔` 或 `讀取` → 讀取主存檔資料夾
- `讀檔 01` 或 `讀取 01` → 讀取手動存檔點 1
- `讀檔 05` 或 `讀取 05` → 讀取手動存檔點 5
- `讀檔 auto` 或 `讀取 auto` → 讀取最新自動存檔

---

## 上傳操作

**當玩家說「上傳」時:**

**步驟 1: Git Add 所有變更**
```bash
git add .
```

**步驟 2: Git Commit**
```bash
git commit -m "記錄存檔 - [遊戲內日期] - [簡短摘要]"
```

**步驟 3: Git Push**
```bash
git push
```

**Commit message 格式範例:**
- `記錄存檔 - 2026-02-11 - 丹的冒險 (2級戰士)`
- `記錄存檔 - 第11天 - 完成格瑞姆第三次訓練`
- `記錄存檔 - 第15天 - 升級至3級，選擇戰技大師`

**操作說明:**
- 將所有本地變更推送到 GitHub
- 自動執行 add、commit、push 三步驟

**步驟 4: 確認上傳完成**
- 顯示 commit 訊息
- 告知玩家已推送到雲端

---

## 下載操作

**當玩家說「下載」時:**

**執行 Git Pull:**
```bash
git pull
```

**操作說明:**
- 從 GitHub 拉取最新的存檔資料
- 同步雲端的所有變更到本地
- 確保本地存檔是最新版本

**步驟 2: 確認下載完成**
- 顯示更新的檔案列表
- 告知玩家已同步最新資料

---

## 輸出小說操作

**當玩家說「輸出小說」或「生成故事」時:**

**功能說明:**
將當前角色的冒險記錄轉換成小說格式，輸出為獨立的 Markdown 檔案，方便閱讀和分享。

**步驟 1: 確認當前角色**
- 檢查當前 Git 分支和對應的 saves 資料夾
- 確認角色名稱和基本資訊

**步驟 2: 讀取存檔資料**
- 讀取 `saves/[角色資料夾]/character.md` (角色資訊)
- 讀取 `saves/[角色資料夾]/journal.md` (冒險日誌)
- 讀取 `saves/[角色資料夾]/npcs.md` (NPC 關係)
- 讀取 `saves/[角色資料夾]/meta.md` (元資料)

**步驟 3: 處理日誌內容 (整理版風格)**
- 保留原有敘事風格和劇情描寫
- 去除系統資訊:
  - 擲骰結果 (如「d20 = 14」)
  - 判定數值 (如「vs DC 15」)
  - 遊戲機制說明 (如「熟練加值+2」)
  - 系統提示 (如「✅ 已將記錄儲存至...」)
- 整理段落格式，保持閱讀流暢
- 依據日期或重大事件劃分章節

**步驟 4: 組織小說結構**
```markdown
# [角色名]的冒險故事

## 序章 - 角色介紹
[角色基本資訊、背景故事、特殊能力]

## 第一章 - [章節標題]
[冒險內容]

## 第二章 - [章節標題]
[冒險內容]

...

## 附錄 - 重要人物
[NPC 關係和介紹]
```

**步驟 5: 創建輸出檔案**
- 檢查 `novels/` 資料夾是否存在，不存在則創建
- 檔案命名格式: `novels/[角色名]-[日期].md`
- 範例: `novels/阿布拉漢-2026-02-12.md`

**步驟 6: 完成提示**
- **玩家友善表達:** `✨ 已將冒險故事輸出至小說格式`
- 顯示檔案路徑: `novels/[角色名]-[日期].md`
- 顯示檔案大小和章節數量

**小說風格特點:**
- 保留 GM 原有的細膩敘事風格
- 保持沉浸式體驗，去除遊戲系統層面的資訊
- 依時間線串聯劇情，自然流暢
- 適合作為冒險回顧和故事分享

**注意事項:**
- 不修改原有存檔檔案，僅讀取並生成新檔案
- 若 journal.md 內容過少，提示玩家冒險記錄尚不足以生成完整小說
- 每次執行都會覆寫同名小說檔案 (基於當前最新記錄)

---

## 完整工作流程

**推薦的使用流程:**

1. **開始遊戲** → 玩家說「**讀檔**」、「**讀檔 01**」或「**讀檔 auto**」
2. **遊戲進行中** → 持續冒險、互動、戰鬥
3. **新章節/重大事件** → GM 自動執行自動存檔
4. **階段結束** → 玩家說「**存檔**」
5. **重要節點** → 玩家說「**另存新檔**」
6. **備份到雲端** → 玩家說「**上傳**」
7. **其他裝置開始** → 玩家說「**下載**」

---

## 快速參考

| 指令 | 檔案操作 | Git 操作 | 說明 |
|------|---------|---------|------|
| **存檔** | 更新主存檔資料夾 | 無 | 更新所有模組化檔案 |
| **另存新檔** | 複製到 checkpoint-${num}/ | 無 | 新增存檔點 |
| **自動存檔** (GM執行) | 覆寫 -auto/ 資料夾 | 無 | 章節/重大事件自動記錄 |
| **讀檔/讀取** | 讀取主存檔資料夾 | 無 | 載入主存檔繼續冒險 |
| **讀檔/讀取 01** | 讀取 checkpoint-01/ | 無 | 載入存檔點 1 |
| **讀檔/讀取 auto** | 讀取 -auto/ 資料夾 | 無 | 載入最新自動存檔 |
| **上傳** | 無 | `add` + `commit` + `push` | 備份到 GitHub |
| **下載** | 無 | `pull` | 從 GitHub 同步最新資料 |
| **輸出小說** | 生成 novels/[角色名]-[日期].md | 無 | 將冒險記錄轉換為小說格式 |

**典型流程:**
- 🔽 下載 → 📖 讀取 → 🎮 遊戲 → 📌 自動存檔(GM) → 💾 存檔 → 🔼 上傳
- 📖 輸出小說 (任何時候都可以生成當前冒險的小說版本)
